(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7e4194ff"],{b69b:function(t,e,o){},c02d:function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"coupon"},[o("el-container",[o("el-aside",{attrs:{width:"200px"}},[o("NavTo")],1),o("el-container",[o("el-header",{staticStyle:{"border-bottom":"1px solid #d0d0d0","background-color":"#FFFFFF"}},[o("Header")],1),o("transition",{attrs:{appear:"","appear-active-class":"animated fadeInLeft"}},[o("el-main",[o("div",{staticClass:"article"},[o("el-button",{on:{click:t.jumpback}},[t._v("返回")]),t._v("  \n\t\t\t\t\t\t"),o("el-button",{attrs:{type:"primary"},on:{click:t.add_user}},[t._v("添加优惠券")]),o("el-button",{attrs:{type:"primary"},on:{click:t.fa_user}},[t._v("发放优惠券")]),o("div",{staticStyle:{height:"20px"}},[t._v(" ")]),[o("el-dialog",{attrs:{title:"",visible:t.editbox,width:"350px",center:"","close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(e){t.editbox=e}}},[o("el-form",{attrs:{model:t.form_ff}},[o("h1",{attrs:{align:"center"}},[t._v("优惠券发放")]),o("br"),o("el-form-item",{attrs:{label:"选择优惠券:","label-width":t.formLabelWidth}},[o("el-select",{attrs:{placeholder:"请选择优惠券"},model:{value:t.form_ff.yhq,callback:function(e){t.$set(t.form_ff,"yhq",e)},expression:"form_ff.yhq"}},t._l(t.list,(function(e){return 1==e.is_appoint?o("el-option",{attrs:{value:e.id,label:e.name}}):t._e()})),1)],1),o("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"用户昵称",size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.serach(t.value_ff)}},model:{value:t.value_ff,callback:function(e){t.value_ff=e},expression:"value_ff"}}),o("el-button",{staticStyle:{"padding-left":"10px"},attrs:{size:"small"},on:{click:function(e){return t.serach(t.value_ff)}}},[o("i",{staticClass:"el-icon-search"})]),o("el-form-item",{attrs:{label:"选择用户:"}}),t._l(t.list_user,(function(e){return 1==t.is_user?o("span",[o("el-radio",{attrs:{label:e.id},model:{value:t.form_ff.uid,callback:function(e){t.$set(t.form_ff,"uid",e)},expression:"form_ff.uid"}},[t._v(t._s(e.nickname))])],1):t._e()}))],2),o("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.editbox=!1,t.is_user=!1}}},[t._v("返 回")]),0==t.is_user?o("el-button",{attrs:{type:"primary",disabled:""},on:{click:function(e){return t.onSubmit(t.form_ff)}}},[t._v("确 定")]):t._e(),1==t.is_user?o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.onSubmit(t.form_ff)}}},[t._v("确 定")]):t._e()],1)],1),o("el-tabs",{attrs:{type:"border-card"}},[o("el-tab-pane",{attrs:{label:"优惠券列表"}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,border:""}},[o("el-table-column",{attrs:{type:"index",label:"序号",width:"50px"}}),o("el-table-column",{attrs:{prop:"name",label:"优惠券名称"}}),o("el-table-column",{attrs:{prop:"status",label:"使用次数"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(1==e.row.status?"一次":"不限")+"\n\t\t\t\t\t\t\t\t\t")]}}])}),o("el-table-column",{attrs:{prop:"type",label:"类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(1==e.row.type?"店铺优惠券":"其他")+"\n\t\t\t\t\t\t\t\t\t")]}}])}),o("el-table-column",{attrs:{prop:"is_appoint",label:"发放方式"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(1==e.row.is_appoint?"指定发放":"平台领取")+"\n\t\t\t\t\t\t\t\t\t")]}}])}),o("el-table-column",{attrs:{prop:"goods_ids",label:"可使用商品"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(0==e.row.goods_ids?"全部商品":"部分商品")+"\n\t\t\t\t\t\t\t\t\t")]}}])}),o("el-table-column",{attrs:{prop:"full",label:"满多少"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.full?[t._v("无门槛")]:[t._v(t._s(e.row.full))]]}}])}),o("el-table-column",{attrs:{prop:"reduce",label:"减多少"}}),o("el-table-column",{attrs:{prop:"start_time",label:"起始时间"}}),o("el-table-column",{attrs:{prop:"end_time",label:"结束时间"}}),o("el-table-column",{attrs:{prop:"stock",label:"库存"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.stock?[t._v(t._s(e.row.stock))]:[t._v("无限张")]]}}])}),o("el-table-column",{attrs:{prop:"operation",label:"操作",width:"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{staticStyle:{"margin-left":"10px"},attrs:{slot:"reference",type:"danger",size:"small"},on:{click:function(o){return t.del(e.row.id)}},slot:"reference"},[t._v("删除")])]}}])}),o("strong")],1)],1),o("el-tab-pane",{attrs:{label:"指定发放"},on:{click:function(e){return t.get_give_coupon(4)}}},[o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.get_give_coupon(4)}}},[t._v("全部")]),o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.get_give_coupon(0)}}},[t._v("未使用")]),o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.get_give_coupon(1)}}},[t._v("已使用")]),o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.get_give_coupon(2)}}},[t._v("已完成")]),o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.get_give_coupon(3)}}},[t._v("已过期")]),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.give_coupon_alit,border:""}},[o("el-table-column",{attrs:{type:"index",label:"序号",width:"50px"}}),o("el-table-column",{attrs:{prop:"users.nickname",label:"用户名"}}),o("el-table-column",{attrs:{prop:"coupons.name",label:"优惠券名称"}}),o("el-table-column",{attrs:{prop:"type",label:"类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t\t\t\t   \t\t\t"+t._s(1==e.row.type?"店铺优惠券":"其他")+"\n\t\t\t\t\t\t\t\t   \t\t")]}}])}),o("el-table-column",{attrs:{prop:"goods_ids",label:"可使用商品"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t\t\t\t   \t\t\t"+t._s(0==e.row.goods_ids?"全部商品":"部分商品")+"\n\t\t\t\t\t\t\t\t   \t\t")]}}])}),o("el-table-column",{attrs:{prop:"full",label:"满多少"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.full?[t._v("无门槛")]:[t._v(t._s(e.row.full))]]}}])}),o("el-table-column",{attrs:{prop:"reduce",label:"减多少"}}),o("el-table-column",{attrs:{prop:"create_time",label:"起始时间"}}),o("el-table-column",{attrs:{prop:"end_time",label:"结束时间"}}),o("el-table-column",{attrs:{prop:"goods_ids",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.status?o("a",[t._v(" 未使用")]):t._e(),1==e.row.status?o("a",[t._v(" 已使用")]):t._e(),2==e.row.status?o("a",[t._v(" 已完成")]):t._e(),3==e.row.status?o("a",[t._v(" 已过期")]):t._e()]}}])}),o("el-table-column",{attrs:{prop:"operation",label:"操作",width:"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{staticStyle:{"margin-left":"10px"},attrs:{slot:"reference",type:"danger",size:"small"},on:{click:function(o){return t.del_user_coupon(e.row.id)}},slot:"reference"},[t._v("删除")])]}}])}),o("strong")],1),o("el-pagination",{staticStyle:{"padding-top":"60px","text-align":"center"},attrs:{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.size},on:{"current-change":t.jump_page}})],1)],1)]],2)])],1)],1)],1)],1)},l=[],a=o("15fc"),s=o("71c2"),i={data:function(){return{status:"1",goods_ids:"0",dialogImageUrl:"",dialogVisible:!1,oid:0,form:{},list:[],value:"",fa_yhq:0,editbox:!1,is_user:!1,yhq:[],form_ff:[],list_user:[],value_ff:"",give_coupon:[],give_coupon_alit:[],coupon_stuta:4,total:0,size:10}},components:{Header:s["a"],NavTo:a["a"]},methods:{jumpback:function(){this.$router.push({path:"/extend/application"})},handleRemove:function(t,e){console.log(t,e)},add_user:function(){this.$router.push({path:"./addcoupon"})},fa_user:function(){this.editbox=!0},onSubmit:function(t){var e=this;console.log("确认发放优惠券"),console.log(t),this.http.get("coupon/admin/give_coupon?uid="+t.uid+"&cid="+t.yhq).then((function(t){null==t.data&&e.$message({showClose:!1,message:t.msg,type:"error"}),t.data>0&&(e.get_give_coupon(0),e.$message({showClose:!0,message:t.msg,type:"success"}))}))},serach:function(t){var e=this;this.http.get("user/admin/get_user_name?name="+t).then((function(t){e.list_user=t.data,console.log("返回用户"),e.is_user=!0,t.data.length<1&&(e.$message({showClose:!1,message:"没有搜到用户",type:"error"}),e.is_user=!1)}))},get_give_coupon:function(t){var e=this;this.coupon_stuta=t,this.http.get("coupon/admin/get_give_coupon?state="+t).then((function(t){e.give_coupon=t.data,e.total=t.data.length,e.give_coupon_alit=e.give_coupon.slice(0,e.size),console.log("返回优惠券",e.total),t.data.length<1&&e.$message({showClose:!1,message:"没有数据",type:"error"})}))},edit:function(t){this.form=t,this.dialogVisible=!0},get_coupon:function(){var t=this;this.http.get("coupon/admin/get_coupon").then((function(e){t.list=e.data}))},del:function(t){var e=this,o=this;this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.http.put_show("coupon/admin/del_coupon",{id:t}).then((function(){o.$message({showClose:!0,message:"删除成功",type:"success"}),e.get_coupon()}))}))},del_user_coupon:function(t){var e=this;console.log("删除发放的指定优惠券");var o=this;this.http.put_show("coupon/admin/del_give_coupon",{id:t}).then((function(){o.$message({showClose:!0,message:"删除成功",type:"success"}),e.get_give_coupon(e.coupon_stuta)}))},jump_page:function(t){var e=this,o=(t-1)*e.size,n=t*e.size;console.log(o,n),this.give_coupon_alit=this.give_coupon.slice(o,n)}},mounted:function(){this.get_coupon(),this.get_give_coupon(4)}},r=i,u=(o("fbe1"),o("2877")),c=Object(u["a"])(r,n,l,!1,null,null,null);e["default"]=c.exports},fbe1:function(t,e,o){"use strict";o("b69b")}}]);